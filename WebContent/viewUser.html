<!DOCTYPE html>
<html lang="en">
	<head>
		<!--Required meta tags-->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<!--Logo to appear in the tab-->
		<link rel="icon" type="image/x-icon" href="./images/logo.ico">
		
		<!--Bootstrap CSS-->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		
		<script src="https://kit.fontawesome.com/b56caf5f15.js" crossorigin="anonymous"></script>
		<title>View User</title>
		<style>
		.display-6{
			font-size: 2.0rem;
		}
		
		.card{
			display: inline-block;
		}
		
		.overflow-auto{
			width: 150px;
			height: 40px;
			overflow: auto;
		}
		</style>
	</head>
	<body onload="checkURL()">
		<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
			<div class="container-fluid">
				<a class="navbar-brand mb-0 h1">
					<img src="./images/logo.png" alt="" width="40" height="24" class="d-inline-block align-text-top">
					Pawlendar
				</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav">
						<li class="nav-item">
							<a class="nav-link" href="profile.html">My Profile</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="findusers.html">Find Users</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="container-fluid">
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav ms-auto">
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
									<path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
									<path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
								</svg>
							</a>
							<ul class="dropdown-menu dropdown-menu-lg-dark" aria-labelledby="navbarDropdown">
								<li><a class="dropdown-item" href="manageinfo.html">Manage Account</a></li>
								<li><a class="dropdown-item" href="index.html">Logout</a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<h1 id="welcomeProfile" class="display-6" align="center">My Profile</h1>
		<div class="container overflow-hidden">
			<div class="row">
				<div class="col-md-auto">
					<h3>About Me</h3>
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16"><path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/><path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/></svg>
					<label for="username"> Username: </label>
					<p id="result1"></p>
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16"><path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10zm0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6z"/></svg>
					<label for="location"> Location: </label>
					<p id="result2"></p>
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-left-quote-fill" viewBox="0 0 16 16"><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4.414a1 1 0 0 0-.707.293L.854 15.146A.5.5 0 0 1 0 14.793V2zm7.194 2.766a1.688 1.688 0 0 0-.227-.272 1.467 1.467 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 5.734 4C4.776 4 4 4.746 4 5.667c0 .92.776 1.666 1.734 1.666.343 0 .662-.095.931-.26-.137.389-.39.804-.81 1.22a.405.405 0 0 0 .011.59c.173.16.447.155.614-.01 1.334-1.329 1.37-2.758.941-3.706a2.461 2.461 0 0 0-.227-.4zM11 7.073c-.136.389-.39.804-.81 1.22a.405.405 0 0 0 .012.59c.172.16.446.155.613-.01 1.334-1.329 1.37-2.758.942-3.706a2.466 2.466 0 0 0-.228-.4 1.686 1.686 0 0 0-.227-.273 1.466 1.466 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 10.07 4c-.957 0-1.734.746-1.734 1.667 0 .92.777 1.666 1.734 1.666.343 0 .662-.095.931-.26z"/></svg>
					<label for="bio"> Bio: </label>
					<div class="overflow-auto"><p id="result3"></p></div>
					<script>
						const urlString = window.location.search;
						const urlParam = new URLSearchParams(urlString);
						const email = urlParam.get('email');
						//XMLHttpRequest object can be used to request data from a web server
						//create the request
						var xhttp = new XMLHttpRequest();
						//function to be executed every time the status of the request object changes
						xhttp.onreadystatechange = function(){
							//when these conditions are met then the response is ready
							if(this.readyState == 4 && this.status == 200){
								//the response text returns the server response as a string
								document.getElementById("result1").innerHTML = this.responseText;
								document.getElementById("welcomeProfile").innerHTML = this.responseText + "'s Profile";
							}
						};
						var url = "http://localhost:8080/Pawlendar/rest/getUsername/" + email;
						xhttp.open("GET", url, true);
						xhttp.send();
					</script>
					<script>
						//XMLHttpRequest object can be used to request data from a web server
						//create the request
						var xhttp = new XMLHttpRequest();
						//function to be executed every time the status of the request object changes
						xhttp.onreadystatechange = function(){
							//when these conditions are met then the response is ready
							if(this.readyState == 4 && this.status == 200){
								//the response text returns the server response as a string
								document.getElementById("result2").innerHTML = this.responseText;
							}
						};
						var url = "http://localhost:8080/Pawlendar/rest/getLocation/" + email;
						xhttp.open("GET", url, true);
						xhttp.send();
					</script>
					<script>
						//XMLHttpRequest object can be used to request data from a web server
						//create the request
						var xhttp = new XMLHttpRequest();
						//function to be executed every time the status of the request object changes
						xhttp.onreadystatechange = function(){
							//when these conditions are met then the response is ready
							if(this.readyState == 4 && this.status == 200){
								//the response text returns the server response as a string
								document.getElementById("result3").innerHTML = this.responseText;
							}
						};
						var url = "http://localhost:8080/Pawlendar/rest/getBio/" + email;
						xhttp.open("GET", url, true);
						xhttp.send();
					</script>
				</div>
			</div>
			<br>
			<div class="row">
				<div class="col">
					<p id="badgeResult">
					<script>
						//XMLHttpRequest object can be used to request data from a web server
						//create the request
						var xhttp = new XMLHttpRequest();
						//function to be executed every time the status of the request object changes
						xhttp.onreadystatechange = function(){
							//when these conditions are met then the response is ready
							if(this.readyState == 4 && this.status == 200){
								//the response text returns the server response as a string
								document.getElementById("badgeResult").innerHTML = this.responseText;
							}
						};
						var url = "http://localhost:8080/Pawlendar/rest/getBadges/" + email;
						xhttp.open("GET", url, true);
						xhttp.send();
					</script>
				</div>
			</div>
			<br>
			<br>
			<div class="row">
				<div class="col">
					<ul class="nav nav-tabs" id="myMenu" role="tablist">
						<li class="nav-item" role="presentation">
							<button class="nav-link" id="pets-tab" data-bs-toggle="tab" data-bs-target="#pets" type="button" role="tab" aria-controls="pets" aria-selected="false">Pets</button>
						</li>
						<li class="nav-item" role="presentation">
							<button class="nav-link" id="tasks-tab" data-bs-toggle="tab" data-bs-target="#tasks" type="button" role="tab" aria-controls="tasks" aria-selected="false">Tasks</button>
						</li>
						<li class="nav-item" role="presentation">
							<button class="nav-link" id="followers-tab" data-bs-toggle="tab" data-bs-target="#followers" type="button" role="tab" aria-controls="followers" aria-selected="false">Followers</button>
						</li>
						<li class="nav-item" role="presentation">
							<button class="nav-link" id="following-tab" data-bs-toggle="tab" data-bs-target="#following" type="button" role="tab" aria-controls="following" aria-selected="false">Following</button>
						</li>
					</ul>
					<div class="tab-content" id="myMenuContent">
						<div class="tab-pane fade" id="pets" role="tabpanel" aria-labelledby="pets-tab">
							<br>
							<button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#followModal">Follow a pet</button>
							<div class="modal fade" id="followModal" tabindex="-1" aria-labelledby="followModal" aria-hidden="true">
								<div class="modal-dialog">
									<div class="modal-content">
										<form id="followPetForm" action="http://localhost:8080/Pawlendar/rest/followPet/" method="post">
											<script>
												var link = document.getElementById("followPetForm");
												link.action = "http://localhost:8080/Pawlendar/rest/followPet/" + localStorage.getItem("emailLoggedin") + "/" + email;
											</script>
											<div class="modal-header">
												<h5 class="modal-title" id="foodModalLabel">Follow a Pet</h5>
												<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
											</div>
											<div class="modal-body">
												<div class="mb-3">
													<label for="myPetList" class="form-label">My Pet</label>
													<select id="resultMyPets" type="text" class="form-select" name="myPetList" id="myPetList" placeholder="My Pet" required>
														<script>
															//XMLHttpRequest object can be used to request data from a web server
															//create the request
															var xhttp = new XMLHttpRequest();
															//function to be executed every time the status of the request object changes
															xhttp.onreadystatechange = function(){
																//when these conditions are met then the response is ready
																if(this.readyState == 4 && this.status == 200){
																	//the response text returns the server response as a string
																	document.getElementById("resultMyPets").innerHTML = this.responseText;
																}
															};
															var url = "http://localhost:8080/Pawlendar/rest/getPetsForMyList/" + localStorage.getItem("emailLoggedin");
															xhttp.open("GET", url, true);
															xhttp.send();
														</script>
													</select>
												</div>
												<div class="mb-3">
													<label for="theirPetList" class="form-label">Their Pet</label>
													<select id="resultTheirPets" type="text" class="form-control" name="theirPetList" id="theirPetList" placeholder="Their Pet" required>
														<script>
															//XMLHttpRequest object can be used to request data from a web server
															//create the request
															var xhttp = new XMLHttpRequest();
															//function to be executed every time the status of the request object changes
															xhttp.onreadystatechange = function(){
																//when these conditions are met then the response is ready
																if(this.readyState == 4 && this.status == 200){
																//the response text returns the server response as a string
																	document.getElementById("resultTheirPets").innerHTML = this.responseText;
																}
															};
															var url = "http://localhost:8080/Pawlendar/rest/getPetsForMyList/" + email;
															xhttp.open("GET", url, true);
															xhttp.send();
														</script>
													</select>
												</div>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button>
												<input type="submit" class="btn btn-secondary" data-bs-dismiss="modal">
											</div>
										</form>
									</div>
								</div>
							</div>	
							<br>	
							<div class="row">
								<div class="col">
									<br>
									<br>
									<p id="resultPets"></p>
									<script>
										//XMLHttpRequest object can be used to request data from a web server
										//create the request
										var xhttp = new XMLHttpRequest();
										//function to be executed every time the status of the request object changes
										xhttp.onreadystatechange = function(){
											//when these conditions are met then the response is ready
											if(this.readyState == 4 && this.status == 200){
												//the response text returns the server response as a string
												document.getElementById("resultPets").innerHTML = this.responseText;
											}
										};
										var url = "http://localhost:8080/Pawlendar/rest/getPetsToView/" + email;
										xhttp.open("GET", url, true);
										xhttp.send();
									</script>
								</div>
							</div>
						</div>
						<div class="tab-pane fade" id="tasks" role="tabpanel" aria-labelledby="tasks-tab">
							<br>
							<h4>My Tasks</h4>
							<table class="col-12">
								<thead>
									<tr>
										<th scope="col">Title</th>
										<th scope="col">Due Date</th>
										<th scope="col">Due Time</th>
										<th scope="col">Pet</th>
										<th scope="col">Content</th>
									</tr>
								</thead>
								<tbody id="resultTasks">
									<script>
										//XMLHttpRequest object can be used to request data from a web server
										//create the request
										var xhttp = new XMLHttpRequest();
										//function to be executed every time the status of the request object changes
										xhttp.onreadystatechange = function(){
											//when these conditions are met then the response is ready
											if(this.readyState == 4 && this.status == 200){
												//the response text returns the server response as a string
												document.getElementById("resultTasks").innerHTML = this.responseText;
											}
										};
										var url = "http://localhost:8080/Pawlendar/rest/getTasksViewUser/" + email;
										xhttp.open("GET", url, true);
										xhttp.send();
									</script>
								</tbody>
							</table>	
						<br>
							<h4>Following Tasks</h4>
							<div class="overflow-auto" style="width: 1300px; height: 600px; overflow: auto;">
								<table class="col-12">
									<thead>
										<tr>
											<th scope="col">Title</th>
											<th scope="col">Due Date</th>
											<th scope="col">Due Time</th>
											<th scope="col">Pet</th>
											<th scope="col">Content</th>
										</tr>
									</thead>
									<tbody id="resultTasks2">
										<script>
											//XMLHttpRequest object can be used to request data from a web server
											//create the request
											var xhttp = new XMLHttpRequest();
											//function to be executed every time the status of the request object changes
											xhttp.onreadystatechange = function(){
												//when these conditions are met then the response is ready
												if(this.readyState == 4 && this.status == 200){
													//the response text returns the server response as a string
													document.getElementById("resultTasks2").innerHTML = this.responseText;
												}
											};
											var url = "http://localhost:8080/Pawlendar/rest/getTasksFollowing/" + email;
											xhttp.open("GET", url, true);
											xhttp.send();
										</script>
									</tbody>
								</table>
							</div>
							</div>
						<div class="tab-pane fade" id="followers" role="tabpanel" aria-labelledby="followers-tab">
							<p id = "resultFollowers">
							<script>
								//XMLHttpRequest object can be used to request data from a web server
								//create the request
								var xhttp = new XMLHttpRequest();
								//function to be executed every time the status of the request object changes
								xhttp.onreadystatechange = function(){
									//when these conditions are met then the response is ready
									if(this.readyState == 4 && this.status == 200){
										//the response text returns the server response as a string
										document.getElementById("resultFollowers").innerHTML = this.responseText;
									}
								};
								var url = "http://localhost:8080/Pawlendar/rest/getFollowers/" + email;
								xhttp.open("GET", url, true);
								xhttp.send();
							</script>
						</div>
						<div class="tab-pane fade" id="following" role="tabpanel" aria-labelledby="following-tab">
							<p id = "resultFollowing">
							<script>
								//XMLHttpRequest object can be used to request data from a web server
								//create the request
								var xhttp = new XMLHttpRequest();
								//function to be executed every time the status of the request object changes
								xhttp.onreadystatechange = function(){
									//when these conditions are met then the response is ready
									if(this.readyState == 4 && this.status == 200){
										//the response text returns the server response as a string
										document.getElementById("resultFollowing").innerHTML = this.responseText;
									}
								};
								var url = "http://localhost:8080/Pawlendar/rest/getFollowingView/" +email;
								xhttp.open("GET", url, true);
								xhttp.send();
							</script>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	</body>
</html>